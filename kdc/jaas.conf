// JAAS login configurations for Kerberos authentication testing.
// Download from: http://<kdc-ip>/artifacts/jaas.conf
//
// System properties required:
//   -Djava.security.auth.login.config=<path>/jaas.conf
//   -Djava.security.krb5.conf=<path>/krb5.conf
//   -Dkeytab.path=<directory containing keytabs>

// Direct keytab authentication as oracleuser.
// Use when the application itself IS the Oracle user.
KEYTAB_CONFIG {
   com.sun.security.auth.module.Krb5LoginModule required
   useKeyTab=true
   useTicketCache=false
   renewTicket=false
   keyTab="${keytab.path}/oracleuser.keytab"
   principal="oracleuser@CORP.INTERNAL";
};

// Ticket cache authentication (from kinit on the host).
// Use after running: kinit oracleuser@CORP.INTERNAL
CACHE_CONFIG {
   com.sun.security.auth.module.Krb5LoginModule required
   useTicketCache=true
   ticketCache="${ticket.cache}"
   doNotPrompt=true
   debug=true;
};

// DataDirect JDBC driver keytab login (same as KEYTAB_CONFIG
// but with debug enabled for troubleshooting).
JDBC_DRIVER_01 {
   com.sun.security.auth.module.Krb5LoginModule required
   useKeyTab=true
   useTicketCache=false
   renewTicket=false
   debug=true
   keyTab="${keytab.path}/oracleuser.keytab"
   principal="oracleuser@CORP.INTERNAL";
};

// Constrained delegation: webappuser impersonates AD users
// (e.g. winuser) and connects to Oracle on their behalf via
// S4U2Self + S4U2Proxy.
//
// Requires storeKey=true and isInitiator=true so the GSSAPI
// layer can use the keytab key for S4U2Self protocol transition.
JDBC_DRIVER_CONSTRAINED_DELEGATION {
   com.sun.security.auth.module.Krb5LoginModule required
   useKeyTab=true
   useTicketCache=false
   renewTicket=false
   storeKey=true
   isInitiator=true
   debug=true
   keyTab="${keytab.path}/webappuser.keytab"
   principal="webappuser@CORP.INTERNAL";
};
